# BDRS 1.1 Release Notes #

Welcome to BDRS v1.1!

This release represents the resolution of many known issues from v1.0 and some major enhancements.

## Content ##
The following items of content have been updated.
<pre>
admin/emailUsers<br>
</pre>
The following items of content have been added.
<pre>
admin/editUser added<br>
</pre>

If you do not have any custom content, you may choose to update the modified content pages above by
  * Logging into the BDRS as an Administrator
  * Navigate to the `Edit Content` page through the menu using Admin -> Manage Portal -> Edit Content
  * For each of the items in the list above, select the item in the drop down list and click `Reset Current Content Default`

You do not have to update new content; it will be inserted automatically.

## Database Migration ##
This release includes some [database migrations](DatabaseMigration.md) from revisions: [r97](https://code.google.com/p/ala-citizenscience/source/detail?r=97), [r120](https://code.google.com/p/ala-citizenscience/source/detail?r=120), [r123](https://code.google.com/p/ala-citizenscience/source/detail?r=123), [r134](https://code.google.com/p/ala-citizenscience/source/detail?r=134) and [r168](https://code.google.com/p/ala-citizenscience/source/detail?r=168).

## Changes ##

### Known Issues from Previous Version ###

#### Creating records with a hidden latitude and longitude ####
When creating or editing a record for a project with hidden latitude and longitude fields, the map is not displayed. (see [issue 75](https://code.google.com/p/ala-citizenscience/issues/detail?id=75))

#### Field Guide `Record Now` button ####
You can now record any species from the field guide provided there is at least one project that has the species or a project which contains "All Species".  If there is more than one project, a page listing all of the projects available for that species with a Record Now button for each is displayed.  If there is no project matching the species or all species, a message is displayed and the information page for that species is shown.

### Managed Files ###
  * The managed file interface has been modified to use jqgrid instead of an HTML table.  This allows the table to be collapsed/expanded, sorted by any column, and searched and includes flexible pagination ([issue 32](https://code.google.com/p/ala-citizenscience/issues/detail?id=32) & [issue 15](https://code.google.com/p/ala-citizenscience/issues/detail?id=15))

### Review Pages ###
  * Added preferences for default view type to show on Advanced Review and My Sightings pages ([issue 102](https://code.google.com/p/ala-citizenscience/issues/detail?id=102))

#### Advanced Review ####
  * Added and refined ability for SUPERVISOR and POWER\_USER roles to moderate records ([issue 28](https://code.google.com/p/ala-citizenscience/issues/detail?id=28))
  * Disabled checkboxes for actions that a user is not allowed perform ([issue 23](https://code.google.com/p/ala-citizenscience/issues/detail?id=23))
  * Modified the change handler for the Select All checks in the table to work properly in IE ([issue 56](https://code.google.com/p/ala-citizenscience/issues/detail?id=56))
  * Improved user access in faceting ([issue 24](https://code.google.com/p/ala-citizenscience/issues/detail?id=24) & [issue 63](https://code.google.com/p/ala-citizenscience/issues/detail?id=63))
  * Added descriptive text for Attribute facet ([issue 27](https://code.google.com/p/ala-citizenscience/issues/detail?id=27))
  * Implemented hibernate filters on the Record object which corrects the counts in the facets ([issue 94](https://code.google.com/p/ala-citizenscience/issues/detail?id=94) & [issue 95](https://code.google.com/p/ala-citizenscience/issues/detail?id=95))
  * Corrected the SQL generated by the Multimedia facet ([issue 103](https://code.google.com/p/ala-citizenscience/issues/detail?id=103))

### Record Entry Forms ###
  * Added read-only access for survey forms ([issue 20](https://code.google.com/p/ala-citizenscience/issues/detail?id=20) & [issue 63](https://code.google.com/p/ala-citizenscience/issues/detail?id=63))
  * Modified locked record entry forms to display location attributes ([issue 55](https://code.google.com/p/ala-citizenscience/issues/detail?id=55))
  * Added last modified/created by attributes for record entry forms ([issue 101](https://code.google.com/p/ala-citizenscience/issues/detail?id=101))
  * Added an blank option to select boxes to prevent unintentional selections on the form ([issue 116](https://code.google.com/p/ala-citizenscience/issues/detail?id=116))
  * Removed ability to view public, held records anonymously or by other users ([issue 151](https://code.google.com/p/ala-citizenscience/issues/detail?id=151))

#### Atlas Form ####
  * Fixed jsp error on atlas form when no file attribute is added to the survey ([issue 53](https://code.google.com/p/ala-citizenscience/issues/detail?id=53))

#### Single Site Forms ####
  * Added ability to delete rows from Single Site Multi Species and Single Site All Species Forms ([issue 61](https://code.google.com/p/ala-citizenscience/issues/detail?id=61))
  * Changed alignment of checkboxes and text areas on single site forms ([issue 60](https://code.google.com/p/ala-citizenscience/issues/detail?id=60))
  * Fixed an error caused by leaving the count blank when non-mandatory ([issue 155](https://code.google.com/p/ala-citizenscience/issues/detail?id=155))

#### Yearly Sightings Form ####
  * Modified date range on yearly sightings form ([issue 42](https://code.google.com/p/ala-citizenscience/issues/detail?id=42))

#### Default (Tracker) Form ####
  * Made species editable on record edit ([issue 117](https://code.google.com/p/ala-citizenscience/issues/detail?id=117))

### Locations ###
  * Removed whitespace from Location description on Location editing page ([issue 72](https://code.google.com/p/ala-citizenscience/issues/detail?id=72))
  * Fixed javascript error on entering locations ([issue 10](https://code.google.com/p/ala-citizenscience/issues/detail?id=10))
  * Modified /webservice/survey/locationsForSurvey.htm to correctly report latitude and longitude ([issue 12](https://code.google.com/p/ala-citizenscience/issues/detail?id=12))
  * Added filtering of location attributes by survey to prevent them from being shared between surveys ([issue 62](https://code.google.com/p/ala-citizenscience/issues/detail?id=62))

### Census Methods ###
  * Fixed javascript error on editing census method attributes ([issue 81](https://code.google.com/p/ala-citizenscience/issues/detail?id=81))
  * Added the HTML editor for Census Method attribute editing ([issue 37](https://code.google.com/p/ala-citizenscience/issues/detail?id=37))

### Moderation ###
  * Changed access control for moderators ([issue 17](https://code.google.com/p/ala-citizenscience/issues/detail?id=17))
  * Added ability to specify email addresses for moderation emails to be sent to ([issue 21](https://code.google.com/p/ala-citizenscience/issues/detail?id=21))

### Maps ###
  * Modified public maps to zoom to extent of records displayed ([issue 29](https://code.google.com/p/ala-citizenscience/issues/detail?id=29))
  * Fixed map zooming when using the geocode search capability ([issue 78](https://code.google.com/p/ala-citizenscience/issues/detail?id=78))

### Form Builder ###
  * Added row highlighting to form builder to indicate when there are thresholds on attributes/properties ([issue 31](https://code.google.com/p/ala-citizenscience/issues/detail?id=31))
  * Created new attribute type "HTML (Not Validated)" to allow entry of HTML without open/close tags ([issue 36](https://code.google.com/p/ala-citizenscience/issues/detail?id=36))
  * Added duplicate buttons to the top and bottom of form for better usability ([issue 112](https://code.google.com/p/ala-citizenscience/issues/detail?id=112))

### New Pages ###
  * Created landing pages for the Contribute, Review, Admin and Profile menu items ([issue 48](https://code.google.com/p/ala-citizenscience/issues/detail?id=48))

### CSS ###
  * Enhanced the default (vanilla) theme with changes to the jquery themeroller style ([issue 39](https://code.google.com/p/ala-citizenscience/issues/detail?id=39) & [issue 41](https://code.google.com/p/ala-citizenscience/issues/detail?id=41) & [issue 50](https://code.google.com/p/ala-citizenscience/issues/detail?id=50) & [issue 51](https://code.google.com/p/ala-citizenscience/issues/detail?id=51))
  * Added white-space: pre; styling to long text attribute types to preserve whitespace when displaying ([issue 64](https://code.google.com/p/ala-citizenscience/issues/detail?id=64))

### Theme ###
  * Made request context available to static pages in themes ([issue 96](https://code.google.com/p/ala-citizenscience/issues/detail?id=96))

### ALA Species Import ###
  * Changed ALA import to allow import of full profiles ([issue 73](https://code.google.com/p/ala-citizenscience/issues/detail?id=73))

### Species Profile Templates ###
  * Fixed loop termination conditions that would cause an error when the number of groups < number of items in each group ([issue 115](https://code.google.com/p/ala-citizenscience/issues/detail?id=115))

### Libraries ###
  * Changed JSON library to http://code.google.com/p/json-simple/ to prevent loss of precision in decimal values ([issue 76](https://code.google.com/p/ala-citizenscience/issues/detail?id=76))
  * Modified ketchup validation regular expression for attribute options on form builder to allow punctuation ([issue 82](https://code.google.com/p/ala-citizenscience/issues/detail?id=82))

### Javascript ###
  * Removed byte order marking on jquery.blockUI.js ([issue 80](https://code.google.com/p/ala-citizenscience/issues/detail?id=80))

### Exceptions ###
  * Fixed exceptions thrown when transactions are committed ([issue 111](https://code.google.com/p/ala-citizenscience/issues/detail?id=111))

### Web Services ###
  * Added a web service that returns taxon by taxon group name search ([issue 118](https://code.google.com/p/ala-citizenscience/issues/detail?id=118))

## Known Issues ##
We’ve done our best to make BDRS 1.1 as solid as possible, but as is always the case with software, there are a couple of issues that we know about in this release.

### Errors when editing unpublished survey forms ###
There is currently an error that prevents "default" forms from being edited when they are not published.
If you encounter an error 500 when trying to edit a survey form, check to see if the form is published.

### Creating records with a hidden/non-mandatory when or time field ###
Internally the BDRS stores the darwin core `date` and `time` fields as a single date-time value in the database. This means that if the date or time field is hidden or not set, the BDRS is forced to create a default value for the field so that the value can be stored in the database.

For the moment, we recommend that the `date` and `time` fields are either both mandatory or both hidden to ensure that any dates and times entered are accurate (without the need for default data).

By default the date is January 1, 1970, 00:00:00.

### Project access for child user groups ###
When configuring user group access to a project, only members of the specified group are given access to a project. For example,

  * Group A contains User X, User Y and Group B.
  * Group B contains User Z.

If Group A is added to a project and then only User X and User Y will have access to the project. User Z will not have access to the project.

### Adding taxonomy groups to a project ###
When adding taxonomy groups to a project, only the taxa in the group at the time of submission will be added to the project. If a taxa is added to the group at a later time, this taxa will not be added to the project.

As a workaround you can edit the relevant project and re-save the group selection to add the missing taxa.

### Adding a selection of species to a project ###
If a project is configured to have a selection of species, when the project taxonomy is modified, the page shows all of the taxon groups containing the selected species instead of the original selection of species.

Rest assured that unless the user clicks save, the original selection of species is retained. To modify the selection of species, re-select the `Selection of Species` option and modify the list as appropriate.

### Bulk data menu item ###
Currently it is important that the Bulk Data menu item is not renamed in the `menu.config` file if you wish to ensure that the item appears last on the contribute menu.

### Spreadsheet upload ###
Spreadsheet cells corresponding to `Integer Range` and `Selection` field types are not validated during upload.

### Displaying the last modified record on a map ###
When a record is created or modified, the `MySightings` page will show the position of the record on a map as a red point. Sometimes the record may occupy the same position as another record. In these cases, the modified record will be displayed in red, on top of the other records at the same position. This means that when you click on the point, you will in fact be clicking on the top most record and will only see details for that record in the popup. Specifically, you will not be able to view all the records at that position using the popup.

If you navigate to the `MySightings` view using the menu, then no particular record will be highlighted in red and you can view all records as normal by clicking on the point.

### Gallery and Gallery Widget ###
The Gallery and Gallery Widget has been temporarily removed from the user interface while we improve this feature to meet quality standards.

### Species Auto-completion ###
The species auto-complete widget on record entry forms does not set the species if you paste in the species name.  You must select a value from the auto-complete pop-up list in order for the species to be set.

### Single-Site All Species form type ###
When a `Multi Select`, `Single Checkbox` or `Multi Checkbox` field is added to a project with `Single-Site All Species` form type, a record will be created for each species even if none of the entries were modified on the form.

The reason that all records are saved for these field types is because they are represented on the screen as checkboxes or multi-select lists. By their nature, these widgets contain information when they are ticked and also when they are not ticked. Therefore it is not possible to discern the difference between an intentionally unselected widget and an ignored widget.

### Javascript validation on Single-Site Multi-Species and Single-Site All Species ###
On the `Single-Site Multi-Species` and `Single-Site All Species` projects, if the table is wide enough to require a horizontal scrollbar, javascript errors that are normally displayed using a popup balloon will not be positioned correctly.

### File and Image Attributes on the Yearly Sightings Form ###
File and Image uploads to a `Yearly Sightings` project will be overridden if any records are added or modified.

It is recommended that until this issue is resolved, users should avoid using these field types on a `Yearly Sightings` project.

### Popup dialog width on Internet Explorer 7 ###
Dialog popups in Internet Explorer 7 are incorrectly formatted and are drawn with 100% screen width.

See jQuery UI Ticket [#4437](http://bugs.jqueryui.com/ticket/4437) for more information

### Maps Inside Iframes ###
If you want to use the BDRS inside an iframe, you must apply the change from [issue 6](https://code.google.com/p/ala-citizenscience/issues/detail?id=6).

### Ketchup Validation ###
When using the jQuery datepicker widgets, it is possible to get a ketchup popup on the input that the datepicker is attached to which disappears after you've selected a date (see [issue 40](https://code.google.com/p/ala-citizenscience/issues/detail?id=40)).

### Deleting Users ###
The system currently does not allow you to delete users.  You can disable accounts, but all of their associated data remains available in the system (see [issue 44](https://code.google.com/p/ala-citizenscience/issues/detail?id=44)).

### Buttons in IE ###
The css for the buttons causes a strange overlayed effect in Internet Explorer (see [issue 47](https://code.google.com/p/ala-citizenscience/issues/detail?id=47)).

### Deleting Taxonomy ###
Currently, there is no mechanism for deleting taxonomies (see [issue 49](https://code.google.com/p/ala-citizenscience/issues/detail?id=49)).

### Redirection to Survey Forms ###
If you try to enter a new survey form (to add a record) anonymously, you are prompted to log in, however, once you log in, you are not redirected to the page you requested.  This is due to a recent change in the accessibility of these forms (see [issue 90](https://code.google.com/p/ala-citizenscience/issues/detail?id=90)).

### Record Now Form Selection ###
The Record Now button on the field guide always redirects to the tracker form instead of the appropriate form for that survey (see [issue 91](https://code.google.com/p/ala-citizenscience/issues/detail?id=91)).

### Adding User Groups ###
A new user group is added each time you visit the Add User Group page, even if the page is not saved (see [issue 122](https://code.google.com/p/ala-citizenscience/issues/detail?id=122)).  Adding users to the group refreshes the page and it is possible to lose changes (see [issue 123](https://code.google.com/p/ala-citizenscience/issues/detail?id=123)).

### Email Recipient Selector ###
The email recipient selector (in the Email Users page) does not show users for groups or for surveys (see [issue 124](https://code.google.com/p/ala-citizenscience/issues/detail?id=124)).

### Survey Editing Access ###
Roles SUPERVISOR and POWER\_USER have survey creation/editing capability, yet only surveys to which they have been explicitly added to or contributed to show in their list of surveys available for edit (see [issue 126](https://code.google.com/p/ala-citizenscience/issues/detail?id=126)).
These roles also cannot add specific users to a survey because they cannot use the user search capability (see [issue 133](https://code.google.com/p/ala-citizenscience/issues/detail?id=133)).

### Location Attribute Rendering ###
Location attributes of type Data File or Image File appear wrapped in the location editing page (see [issue 127](https://code.google.com/p/ala-citizenscience/issues/detail?id=127)). These attributes also appear as a filename instead of a thumbnail on the survey forms (see [issue 128](https://code.google.com/p/ala-citizenscience/issues/detail?id=128)).
Attributes of type HTML, Comment, or Horizontal Rule do not appear at all on the page (see [issue 129](https://code.google.com/p/ala-citizenscience/issues/detail?id=129)).

### Error Map Not Cleared After Every Request ###
It is possible for errors to show on a new form if they have been preserved from a previous request (see [issue 132](https://code.google.com/p/ala-citizenscience/issues/detail?id=132)).

### My Sightings Visibility ###
The My Sightings page filters out records that you should be able to see based on user role and record visibility (see [issue 139](https://code.google.com/p/ala-citizenscience/issues/detail?id=139)).  It should use the same hibernate filters as the Advanced Review page.